<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Välkommen till påskäggsköparsidan!</title>
    <style>
        body {
            margin-left: auto;
            margin-right: auto;
            width: 70%;

        }
        h1 {
            text-align: center;
        }
        h2 {
            text-align: center;
        }
        h3 {
            text-align: center;
        }
        div {
            text-align: center;
        }

    </style>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            socket = io('http://localhost:8081')

            socket.on('hello', (data) => {
                console.log('Connected to server')
                sessionStorage.removeItem('customerLoggedIn')
                sessionStorage.removeItem('producerLoggedIn')
                sessionStorage.removeItem('currentEggPrice')
                sessionStorage.removeItem('mongoId')
                sessionStorage.removeItem('mongoIds')
                sessionStorage.removeItem('eggNames')
            })

            socket.on('LoggedInAsCustomer', (data) => {
                if ( data.loggedIn ) {
                    sessionStorage.setItem('customerLoggedIn', data.id)
                    window.location.href = 'http://localhost:8081/eggs/'
                } else {
                    alert("Wrong username or password!")
                }
            })

            socket.on('LoggedInAsProducer', (data) => {
                console.log(data)
                if ( data.loggedIn ){

                sessionStorage.setItem('producerLoggedIn', data.id)
                window.location.href = 'http://localhost:8081/producer/'
                } else {
                    alert("Wrong username or password!")
                }
            })
        })
        
        function loginCustomer() {
          let loginData = {}
          loginData.username =  document.getElementById("userNameCustomer").value
          loginData.password =  document.getElementById("passwordCustomer").value
          socket.emit('loginCustomer', loginData)
        }

        function loginProducer() {
          let loginData = {}
          loginData.username =  document.getElementById("userNameProducer").value
          loginData.password =  document.getElementById("passwordProducer").value
          socket.emit('loginProducer', loginData)
        }

    </script>
</head>
<body>
    <h1>Welcome to the easter egg candy shop!</h1>
    <h2>Please login and do something useful in your life.</h2>
    
    <section>
        <h3>Log in as a customer</h3>
        <div>
            Username: <input type="text" id="userNameCustomer"><br><br>
            Password : <input type="password" id="passwordCustomer"><br><br>
            <input type="button" onclick="loginCustomer()" value="Submit">
        </div>

    </section>

    <section>
        <h3>Log in as a producer</h3>
        <div>
            Username: <input type="text" id="userNameProducer"><br><br>
            Password : <input type="password" id="passwordProducer"><br><br>
            <input type="button" onclick="loginProducer()" value="Submit">
        </div>

    </section>

</body>
</html>